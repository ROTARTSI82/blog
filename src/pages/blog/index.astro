---
import {getCollection} from "astro:content";
import Layout from "../../layouts/Layout.astro";
import {link} from "../../blog-util";

const posts = (await getCollection('blog'))
  .filter(p => !(p.data.tags ?? "")
    .split(',').includes('hide-ls'))
  .sort((a, b) =>
    b.data.created.valueOf() - a.data.created.valueOf());

const opt: Intl.DateTimeFormatOptions = {year: 'numeric', month: 'short', day: '2-digit'};
---

<Layout title="Grant's Blog - Index">
  <h1>Blog Posts</h1>
  <a href={link("root/")}>File Explorer</a>
  <ol class="list-decimal list-inside mt-2">
    {posts.map(post => {
      const path = post.id.split('/');
      path.pop();

      return <li>
        {post.data.created.toLocaleDateString(undefined, opt)}
          <!--<code class="ml-auto">{path.join('/')}/</code>-->
          <a href={link(`/blog/${post.id}/`)}>
            {post.data.title}
          </a>
          <!-- <span>{post.data.subhead ?? ""}</span> -->
      </li>
    })}
  </ol>
</Layout>
